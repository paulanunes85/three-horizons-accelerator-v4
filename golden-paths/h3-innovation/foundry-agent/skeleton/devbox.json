{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/main/.schema/devbox.schema.json",
  "name": "${{ values.agentName | default('ai-foundry-agent') }}",
  "packages": [
    "python@3.12",
    "poetry@latest",
    "git@latest",
    "curl@latest",
    "jq@latest",
    "yq@latest",
    "gh@latest",
    "azure-cli@latest",
    "kubectl@latest",
    "kubernetes-helm@latest",
    "docker@latest",
    "docker-compose@latest"
  ],
  "env": {
    "AGENT_NAME": "${{ values.agentName | default('my-agent') }}",
    "ENVIRONMENT": "development",
    "PYTHONDONTWRITEBYTECODE": "1",
    "PYTHONUNBUFFERED": "1"
  },
  "shell": {
    "init_hook": [
      "echo 'ðŸ¤– Three Horizons - H3 AI Foundry Agent'",
      "echo 'Agent: ${{ values.agentName }}'",
      "echo 'Model: ${{ values.primaryModel | default(\"gpt-4o\") }}'",
      "echo ''",
      "if [ -f .venv/bin/activate ]; then source .venv/bin/activate; fi",
      "if [ -f .env ]; then set -a; source .env; set +a; fi"
    ],
    "scripts": {
      "setup": [
        "python -m venv .venv",
        "source .venv/bin/activate",
        "pip install --upgrade pip",
        "pip install -r requirements.txt",
        "if [ -f requirements-dev.txt ]; then pip install -r requirements-dev.txt; fi",
        "if [ -f .pre-commit-config.yaml ]; then pre-commit install; fi",
        "echo 'âœ… AI Agent environment ready!'"
      ],
      "run": [
        "source .venv/bin/activate",
        "python src/agent.py"
      ],
      "chat": [
        "source .venv/bin/activate",
        "python -m src.cli"
      ],
      "test": [
        "source .venv/bin/activate",
        "pytest -v --cov=src"
      ],
      "evaluate": [
        "source .venv/bin/activate",
        "python -m src.evaluation.run_evaluation"
      ],
      "lint": [
        "source .venv/bin/activate",
        "ruff check src tests",
        "black --check src tests",
        "mypy src"
      ],
      "format": [
        "source .venv/bin/activate",
        "ruff check --fix src tests",
        "black src tests"
      ],
      "build": [
        "docker build -t $AGENT_NAME:dev ."
      ],
      "deploy-dev": [
        "kubectl apply -k kubernetes/overlays/dev"
      ],
      "az-login": [
        "az login",
        "echo 'âœ… Logged in to Azure'"
      ],
      "trace": [
        "source .venv/bin/activate",
        "python -m src.tracing.view_traces"
      ]
    }
  }
}
