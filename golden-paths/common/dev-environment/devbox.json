{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/main/.schema/devbox.schema.json",
  "name": "${{ values.name | default('three-horizons-service') }}",
  "packages": [
    "git@latest",
    "curl@latest",
    "jq@latest",
    "yq@latest",
    "gh@latest",
    "azure-cli@latest",
    "terraform@latest",
    "kubectl@latest",
    "kubernetes-helm@latest",
    "kustomize@latest",
    "argocd@latest",
    "docker@latest",
    "docker-compose@latest"
  ],
  "env": {
    "PROJECT_NAME": "${{ values.name | default('my-service') }}",
    "ENVIRONMENT": "development"
  },
  "shell": {
    "init_hook": [
      "echo 'üöÄ Three Horizons Development Environment'",
      "echo ''",
      "echo 'üìù Available commands:'",
      "echo '   devbox run setup    - Initial project setup'",
      "echo '   devbox run build    - Build the project'",
      "echo '   devbox run test     - Run tests'",
      "echo '   devbox run lint     - Run linters'",
      "echo '   devbox run deploy   - Deploy to dev environment'",
      "echo ''",
      "if [ -f .env ]; then set -a; source .env; set +a; fi"
    ],
    "scripts": {
      "setup": [
        "echo 'üì¶ Setting up project...'",
        "if [ -f requirements.txt ]; then pip install -r requirements.txt; fi",
        "if [ -f package.json ]; then npm install; fi",
        "if [ -f go.mod ]; then go mod download; fi",
        "if [ -f pom.xml ]; then mvn dependency:resolve; fi",
        "if [ -f .pre-commit-config.yaml ]; then pre-commit install; fi",
        "echo '‚úÖ Setup complete!'"
      ],
      "build": [
        "if [ -f Dockerfile ]; then docker build -t $PROJECT_NAME:dev .; fi"
      ],
      "test": [
        "if [ -f pytest.ini ] || [ -d tests ]; then pytest; fi",
        "if [ -f package.json ]; then npm test; fi",
        "if [ -f go.mod ]; then go test ./...; fi"
      ],
      "lint": [
        "if [ -f .pre-commit-config.yaml ]; then pre-commit run --all-files; fi"
      ],
      "deploy-dev": [
        "echo 'üöÄ Deploying to dev...'",
        "kubectl apply -k deploy/kubernetes/overlays/dev"
      ],
      "az-login": [
        "az login",
        "echo '‚úÖ Logged in to Azure'"
      ]
    }
  },
  "include_plugin": [
    "github:jetify-com/devbox-plugins?dir=docker"
  ]
}
