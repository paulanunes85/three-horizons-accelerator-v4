{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/main/.schema/devbox.schema.json",
  "name": "${{ values.name | default('new-microservice') }}",
  "packages": [
    "git@latest",
    "curl@latest",
    "jq@latest",
    "yq@latest",
    "gh@latest",
    "azure-cli@latest",
    "kubectl@latest",
    "kubernetes-helm@latest",
    "kustomize@latest",
    "docker@latest",
    "docker-compose@latest"
  ],
  "env": {
    "PROJECT_NAME": "${{ values.name | default('my-service') }}",
    "ENVIRONMENT": "development"
  },
  "shell": {
    "init_hook": [
      "echo 'ðŸš€ Three Horizons - H1 Foundation Microservice'",
      "echo 'Project: ${{ values.name }}'",
      "echo ''",
      "echo 'Commands: devbox run [setup|dev|test|build|deploy-dev]'",
      "echo ''",
      "if [ -f .env ]; then set -a; source .env; set +a; fi"
    ],
    "scripts": {
      "setup": [
        "echo 'ðŸ“¦ Setting up project dependencies...'",
        "if [ -f requirements.txt ]; then python -m venv .venv && source .venv/bin/activate && pip install -r requirements.txt; fi",
        "if [ -f package.json ]; then npm install; fi",
        "if [ -f go.mod ]; then go mod download; fi",
        "if [ -f pom.xml ]; then mvn dependency:resolve; fi",
        "echo 'âœ… Setup complete!'"
      ],
      "dev": [
        "docker-compose up -d",
        "echo 'ðŸš€ Development services started'"
      ],
      "test": [
        "if [ -f pytest.ini ]; then source .venv/bin/activate && pytest; fi",
        "if [ -f package.json ]; then npm test; fi",
        "if [ -f go.mod ]; then go test ./...; fi"
      ],
      "build": [
        "docker build -t $PROJECT_NAME:dev ."
      ],
      "deploy-dev": [
        "kubectl apply -k deploy/kustomization.yaml"
      ],
      "logs": [
        "docker-compose logs -f"
      ],
      "stop": [
        "docker-compose down"
      ]
    }
  }
}
