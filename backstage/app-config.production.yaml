# Agentic DevOps Platform (Backstage) Production Config
app:
  title: ${PORTAL_NAME:-paulasilvatech} â€” Agentic DevOps Platform
  baseUrl: ${APP_BASE_URL:-http://localhost:7007}

organization:
  name: ${PORTAL_NAME:-paulasilvatech}

backend:
  baseUrl: ${APP_BASE_URL:-http://localhost:7007}
  listen:
    port: 7007
  auth:
    keys:
      - secret: ${BACKEND_SECRET:-supersecret-dev-only}
  database:
    client: pg
    connection:
      host: ${POSTGRES_HOST}
      port: ${POSTGRES_PORT}
      user: ${POSTGRES_USER}
      password: ${POSTGRES_PASSWORD}

auth:
  environment: development
  providers:
    guest:
      dangerouslyAllowOutsideDevelopment: true
    github:
      development:
        clientId: ${GITHUB_APP_CLIENT_ID}
        clientSecret: ${GITHUB_APP_CLIENT_SECRET}
        signIn:
          resolvers:
            - resolver: usernameMatchingUserEntityName
              dangerouslyAllowSignInWithoutUserInCatalog: true

integrations:
  github:
    - host: github.com
      token: ${GITHUB_TOKEN}
      apps:
        - appId: ${GITHUB_APP_ID}
          clientId: ${GITHUB_APP_CLIENT_ID}
          clientSecret: ${GITHUB_APP_CLIENT_SECRET}
          privateKey: ${GITHUB_APP_PRIVATE_KEY}

techdocs:
  builder: local
  generator:
    runIn: local
  publisher:
    type: local

scaffolder: {}

catalog:
  rules:
    - allow: [Component, System, API, Resource, Location, Domain, Template, User, Group]
  locations:
    # -----------------------------------------------------------------
    # Golden Path Templates from GitHub (all 22)
    # -----------------------------------------------------------------
    # H1 Foundation
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h1-foundation/web-application/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h1-foundation/new-microservice/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h1-foundation/basic-cicd/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h1-foundation/documentation-site/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h1-foundation/infrastructure-provisioning/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h1-foundation/security-baseline/template.yaml
      rules:
        - allow: [Template]
    # H2 Enhancement
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/api-microservice/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/microservice/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/api-gateway/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/gitops-deployment/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/event-driven-microservice/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/batch-job/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/data-pipeline/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/reusable-workflows/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h2-enhancement/ado-to-github-migration/template.yaml
      rules:
        - allow: [Template]
    # H3 Innovation
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/rag-application/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/copilot-extension/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/foundry-agent/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/multi-agent-system/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/mlops-pipeline/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/ai-evaluation-pipeline/template.yaml
      rules:
        - allow: [Template]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/golden-paths/h3-innovation/sre-agent-integration/template.yaml
      rules:
        - allow: [Template]
    # -----------------------------------------------------------------
    # Organization Data
    # -----------------------------------------------------------------
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/backstage/examples/org.yaml
      rules:
        - allow: [User, Group, Domain, System]
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/backstage/examples/entities.yaml
    - type: url
      target: https://github.com/3horizons/three-horizons-accelerator/blob/main/backstage/catalog-info.yaml

permission:
  enabled: true

kubernetes:
  serviceLocatorMethod:
    type: multiTenant
  clusterLocatorMethods:
    - type: config
      clusters: []
